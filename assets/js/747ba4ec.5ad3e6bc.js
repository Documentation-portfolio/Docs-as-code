"use strict";(globalThis.webpackChunkdocs_as_code_temp=globalThis.webpackChunkdocs_as_code_temp||[]).push([[714],{8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var i=n(6540);const s={},t=i.createContext(s);function o(e){const r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:r},e.children)}},8642:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/pr-preview","title":"PR Preview Workflow","description":"Create a workflow to build a temporary preview document each time a pull request is raised. The preview file is rendered as a live site before changes are merged. Reviewers can view the preview file to review changes. The preview file ensures review accuracy and reduces regression.","source":"@site/docs/guides/pr-review.md","sourceDirName":"guides","slug":"/guides/pr-preview","permalink":"/Docs-as-code/docs/guides/pr-preview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"pr-preview","title":"PR Preview Workflow","slug":"/guides/pr-preview","sidebar_label":"PR Preview"},"sidebar":"docsAsCodeSidebar","previous":{"title":"Deployment","permalink":"/Docs-as-code/docs/guides/deployment"}}');var s=n(4848),t=n(8453);const o={id:"pr-preview",title:"PR Preview Workflow",slug:"/guides/pr-preview",sidebar_label:"PR Preview"},l="Setup a PR Preview Workflow",d={},c=[];function a(e){const r={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"setup-a-pr-preview-workflow",children:"Setup a PR Preview Workflow"})}),"\n",(0,s.jsx)(r.p,{children:"Create a workflow to build a temporary preview document each time a pull request is raised. The preview file is rendered as a live site before changes are merged. Reviewers can view the preview file to review changes. The preview file ensures review accuracy and reduces regression.\r\nThis procedure uses Netlify as a host for temporary links."}),"\n",(0,s.jsx)(r.p,{children:"Before you begin, perform the following:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"Sign up to Netlify and create a Netlify site for your project."}),"\n",(0,s.jsx)(r.li,{children:"Create a Netlify personal access token."}),"\n",(0,s.jsx)(r.li,{children:"In your repository, add the following secrets:"}),"\n"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"NETLIFY_AUTH_TOKEN"})," = ",(0,s.jsx)(r.code,{children:"<your-netlify-token>"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"NETLIFY_SITE_ID"})," = ",(0,s.jsx)(r.code,{children:"<your-site-id>"})]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["Setup a PR Preview Workflow\r\nStep 1. In the ",(0,s.jsx)(r.strong,{children:"Workflow"})," folder, create a ",(0,s.jsx)(r.code,{children:"pr-review.yaml"})," file.\r\nPaste the following code in the ",(0,s.jsx)(r.code,{children:"pr-review.yaml"})," file."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"name: PR Preview \u2014 Netlify\r\n\r\non:\r\n  pull_request:\r\n    types: [opened, synchronize, reopened]\r\n\r\njobs:\r\n  build-and-deploy-preview:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v4\r\n\r\n      - name: Setup Node\r\n        uses: actions/setup-node@v4\r\n        with:\r\n          node-version: '18'\r\n\r\n      - name: Install deps\r\n        run: npm ci\r\n\r\n      - name: Build\r\n        run: npm run build\r\n\r\n      - name: Deploy to Netlify (preview)\r\n        env:\r\n          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}\r\n          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}\r\n          PR_NUMBER: ${{ github.event.number }}\r\n        run: |\r\n          # deploy without --prod creates a draft/preview deploy on Netlify\r\n          npx netlify-cli deploy --dir=./build --site=$NETLIFY_SITE_ID --auth=$NETLIFY_AUTH_TOKEN --message=\"Preview PR #${PR_NUMBER}\" --json > /tmp/netlify.json\r\n          PREVIEW_URL=$(cat /tmp/netlify.json | jq -r '.url')\r\n          echo \"preview_url=$PREVIEW_URL\" >> $GITHUB_OUTPUT\r\n\r\n      - name: Comment preview URL on PR\r\n        uses: peter-evans/create-or-update-comment@v4\r\n        with:\r\n          token: ${{ secrets.GITHUB_TOKEN }}\r\n          issue-number: ${{ github.event.number }}\r\n          body: |\r\n            \u2705 Netlify preview ready: ${{ steps.build-and-deploy-preview.outputs.preview_url }}\n"})}),"\n",(0,s.jsx)(r.p,{children:"Step 2. Commit and push the file.\r\nIn your terminal, run:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'git add .github/workflows/pr-preview-netlify.yml\r\ngit commit -m "Add PR preview deploy to Netlify"\r\ngit push\n'})}),"\n",(0,s.jsx)(r.p,{children:"Each time a pull request is raised, a preview file is hosted in Netlify, and isposted in the pull review comments."})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);