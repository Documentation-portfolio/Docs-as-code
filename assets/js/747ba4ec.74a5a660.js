"use strict";(globalThis.webpackChunkdocs_as_code_temp=globalThis.webpackChunkdocs_as_code_temp||[]).push([[714],{8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var i=r(6540);const s={},t=i.createContext(s);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:n},e.children)}},8642:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/pr-preview","title":"PR Preview Workflow","description":"Create a workflow to build a temporary preview document each time a pull request is raised. The preview file is rendered as a live site before changes are merged. Reviewers can view the preview file to review changes. The preview file ensures review accuracy and reduces regression.","source":"@site/docs/guides/pr-review.md","sourceDirName":"guides","slug":"/guides/pr-preview","permalink":"/Docs-as-code/docs/guides/pr-preview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"pr-preview","title":"PR Preview Workflow","slug":"/guides/pr-preview","sidebar_label":"Setup a PR Preview Workflow"},"sidebar":"docsAsCodeSidebar","previous":{"title":"Setup a Deployment Workflow","permalink":"/Docs-as-code/docs/guides/deployment"},"next":{"title":"GitHub Actions CI/CD Pipeline","permalink":"/Docs-as-code/docs/guides/github-actions-ci-cd-pipeline-docs"}}');var s=r(4848),t=r(8453);const o={id:"pr-preview",title:"PR Preview Workflow",slug:"/guides/pr-preview",sidebar_label:"Setup a PR Preview Workflow"},l="Setup a PR Preview Workflow",d={},c=[];function a(e){const n={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"setup-a-pr-preview-workflow",children:"Setup a PR Preview Workflow"})}),"\n",(0,s.jsx)(n.p,{children:"Create a workflow to build a temporary preview document each time a pull request is raised. The preview file is rendered as a live site before changes are merged. Reviewers can view the preview file to review changes. The preview file ensures review accuracy and reduces regression.\nThis procedure uses Netlify as a host for temporary links."}),"\n",(0,s.jsx)(n.p,{children:"Before you begin, perform the following:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Sign up to Netlify and create a Netlify site for your project."}),"\n",(0,s.jsx)(n.li,{children:"Create a Netlify personal access token."}),"\n",(0,s.jsx)(n.li,{children:"In your repository, add the following secrets:"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NETLIFY_AUTH_TOKEN"})," = ",(0,s.jsx)(n.code,{children:"<your-netlify-token>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NETLIFY_SITE_ID"})," = ",(0,s.jsx)(n.code,{children:"<your-site-id>"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Setup a PR Preview Workflow\nStep 1. In the ",(0,s.jsx)(n.strong,{children:"Workflow"})," folder, create a ",(0,s.jsx)(n.code,{children:"pr-review.yaml"})," file.\nPaste the following code in the ",(0,s.jsx)(n.code,{children:"pr-review.yaml"})," file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"name: PR Preview \u2014 Netlify\n\non:\n  pull_request:\n    types: [opened, synchronize, reopened]\n\njobs:\n  build-and-deploy-preview:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Setup Node\n        uses: actions/setup-node@v4\n        with:\n          node-version: '18'\n\n      - name: Install deps\n        run: npm ci\n\n      - name: Build\n        run: npm run build\n\n      - name: Deploy to Netlify (preview)\n        env:\n          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}\n          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}\n          PR_NUMBER: ${{ github.event.number }}\n        run: |\n          # deploy without --prod creates a draft/preview deploy on Netlify\n          npx netlify-cli deploy --dir=./build --site=$NETLIFY_SITE_ID --auth=$NETLIFY_AUTH_TOKEN --message=\"Preview PR #${PR_NUMBER}\" --json > /tmp/netlify.json\n          PREVIEW_URL=$(cat /tmp/netlify.json | jq -r '.url')\n          echo \"preview_url=$PREVIEW_URL\" >> $GITHUB_OUTPUT\n\n      - name: Comment preview URL on PR\n        uses: peter-evans/create-or-update-comment@v4\n        with:\n          token: ${{ secrets.GITHUB_TOKEN }}\n          issue-number: ${{ github.event.number }}\n          body: |\n            \u2705 Netlify preview ready: ${{ steps.build-and-deploy-preview.outputs.preview_url }}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Step 2. Commit and push the file.\nIn your terminal, run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'git add .github/workflows/pr-preview-netlify.yml\ngit commit -m "Add PR preview deploy to Netlify"\ngit push\n'})}),"\n",(0,s.jsx)(n.p,{children:"Each time a pull request is raised, a preview file is hosted in Netlify, and isposted in the pull review comments."})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);